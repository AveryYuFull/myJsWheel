/*!
 * my-js-wheel v1.0.10
 * (c) 2017-2019 penyuying
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Wheel={})}(this,function(e){"use strict";function l(e){for(var t=!0,n=0,i=arguments.length,o=Array(1<i?i-1:0),r=1;r<i;r++)o[r-1]=arguments[r];if(o&&o.length<1)return"boolean"==typeof e?{}:e;"boolean"==typeof e&&(t=e,e=o[0],n=1);for(var a=0+n;a<o.length;a++){var s=o[a];if(s instanceof Object)for(var c in s)t&&s[c]instanceof Object?e[c]=l(s[c]instanceof Array?[]:{},s[c]):e[c]=s[c]}return e}function t(){return"undefined"!=typeof window}function o(){return t()&&("ontouchstart"in window||function(){if(!t())return!1;var e=navigator.userAgent||"";return e=e.toLowerCase(),/wechatdevtools/.test(e)}())}var n=function(){var e=document.createElement("div").style,t={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var n in t)if(void 0!==e[t[n]])return n;return!1}();function a(e){return n&&("standard"===n?"transitionEnd"===e&&(e="transitionend"):e=n+e.charAt(0).toUpperCase()+e.substr(1)),e}var i={wheelEl:"",wheelItemEl:"",direction:"vertical",blurWidth:20,itemWidth:0,itemHeight:0,activeCls:"active",visibleCls:"visible",selectedIndex:0,bindToWrapper:!1,disableMouse:o(),disableTouch:!o(),preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},preventDefault:!0,stopPropagation:!0,momentum:!0,momentumLimitTime:300,momentumLimitDistance:15,useTransition:!1,bounceTime:70,deceleration:.001,swipeTime:250,swipeBounceTime:50},m={transform:a("transform"),transformOrigin:a("transformOrigin"),transition:a("transition"),transitionDuration:a("transitionDuration"),transitionTimingFunction:a("transitionTimingFunction"),transitionEnd:a("transitionEnd")},I={touchstart:0,touchmove:0,touchcancel:0,touchend:0,mousedown:1,mousemove:1,mousecancel:1,mouseup:1},x={TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right"},r="beforeScrollStart",c="scrollStart",s="scroll",F="touchEnd",u="scrollEnd";function v(e,t){var n=parseFloat(e),i=n;t=Math.abs(t);var o=2*e,r=180*parseInt(t/o),a=(n*n+i*i-(t%=o)*t)/(2*n*i),s=Math.acos(a);return r+180*s/Math.PI}function d(e,t,n,i){e&&t&&n&&(i=i||!1,e.addEventListener instanceof Function?e.addEventListener(t,n,i):e.attachEvent instanceof Function?e.attachEvent("on"+t,n):e["on"+t]=n)}function f(e,t,n,i){e&&t&&n&&(i=i||!1,e.removeEventListener instanceof Function?e.removeEventListener(t,n,i):e.detachEvent instanceof Function?e.detachEvent("on"+t,n):e["on"+t]=null)}function h(e){return e||window.event}var P={initEventListener:function(n,e,i,o){var r=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return!!(n&&e&&i)&&(r=r||!1,o=o?"add":"remove",e instanceof Array||(e=[e]),e.forEach(function(e){!function(e){var t=null;switch((o||"")+""){case"add":t=d;break;case"remove":t=f}t instanceof Function&&t(n,e,i,r)}(e)}),!0)},addHandler:d,removeHandler:f,getEvent:h,getTarget:function(e){var t=null;return(e=h(e))&&(t=e.target||e.srcElement),t},getButton:function(e){var t=void 0;if(e){var n=e.button+"";if(document.implementation.hasFeature("MouseEvents","2.0"))t=n;else switch(n){case"0":case"1":case"3":case"5":case"7":t="0";break;case"2":case"6":t="2";break;case"4":t="1"}}return t},preventDefault:function(e){(e=h(e))&&(e.preventDefault instanceof Function?e.preventDefault():e.returnValue=!1)},stopPropagation:function(e){(e=h(e))&&(e.stopPropagation instanceof Function?e.stopPropagation():e.cancelBubble=!0)}};function L(){return window&&window.performance&&window.performance.now?window.performance.now()+window.performance.timing.navigationStart:Date.now()}var O={style:"cubic-bezier(0.23, 1, 0.32, 1)",fn:function(e){return 1+--e*e*e*e*e}},S={style:"cubic-bezier(0.165, 0.84, 0.44, 1)",fn:function(e){return 1- --e*e*e*e}};!function(){for(var e=["webkit","moz","o","ms"],o=0,t=0;t<e.length&&!window.requestAnimationFrame;t++){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var t=L(),n=Math.max(0,17-(t-o)),i=setTimeout(function(){e instanceof Function&&e()},n);return o=t+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var p={requestAnimationFrame:window.requestAnimationFrame,cancelAnimationFrame:window.cancelAnimationFrame};function M(e,t,n,i,o){var r=v(e,t),a=0<t?n-r:n+r;return a<i?a=i:o<a&&(a=o),a}function _(e){console.error("[Wheel warn]: "+e)}var g=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function w(e,t){(e=this._getElements(e)[0])?this._init(e,t):_("can not resolve wrapper dom")}w.use=function(e,t){e instanceof Function?e(w,t):e&&e.default instanceof Function?e.default(w,t):_("can not resolve the use module")},w.use(function(e){e.prototype.refresh=function(){var e=this,t=e._el,n=e._options;e._resetItems();var i=t&&t.offsetWidth||0,o=t&&t.offsetHeight||0,r=n.direction||"vertical",a=void 0,s=void 0;"horizontal"===r?(e._r=i/2-n.blurWidth,s=100,a="Width"):"vertical"===r&&(e._r=o/2-n.blurWidth,s=40,a="Height");var c=e._wheelItemsEl,l=c&&c[0];e._itemSize=n["item"+a]||l&&l["offset"+a]||s,e._d=2*e._r,e._itemAngle=parseInt(v(e._r,.8*e._itemSize)),e._beginAngle=0,e._angle=e._beginAngle,e._beginExceed=e._beginAngle-30,e._visibleRange=90,e._highlightRange=e._itemAngle/2,e._calcItemPosition(),e._initItemVisibility(e._angle),0<e.index&&e.wheelTo(e.index)},e.prototype._init=function(e,t){var n=this;n._el=e,n._initOptions(t),n._initEl(e),n.refresh(),n._watchTransition(),n.index=n._options.selectedIndex,0<n.index&&n.wheelTo(n.index)},e.prototype._initOptions=function(e){this._options=l({},i,e)}}),w.use(function(e){e.prototype._bindEvent=function(e){var t=this,n=t._options,i=n.bindToWrapper?t._el:window;o()&&!n.disableTouch&&(P.initEventListener(t._el,"touchstart",t,e),P.initEventListener(i,"touchmove",t,e),P.initEventListener(i,["touchcancel","touchend"],t,e)),n.disableMouse||(P.initEventListener(t._el,"mousedown",t,e),P.initEventListener(i,"mousemove",t,e),P.initEventListener(i,["mousecancel","mouseup"],t,e)),P.initEventListener(t._wheelEl,m.transitionEnd,t,e)},e.prototype.handleEvent=function(e){switch((e=P.getEvent(e))&&e.type||""){case"touchstart":case"mousedown":this._start(e);break;case"touchmove":case"mousemove":this._move(e);break;case"touchend":case"touchcancel":case"mouseup":case"mousecancel":this._end(e);break;case m.transitionEnd:this._transitionEnd(e)}},e.prototype._start=function(e){var t=this,n=(e=P.getEvent(e))&&e.type||"",i=I[n];0!==i&&"0"!==P.getButton(e)||t.initiated&&t.initiated!==i||(t.initiated=i,t._preventEvent(e),t.pointPos=t._getPos(e),t.absStartPos=t.pointPos,t.startPos=t.pointPos,t.movingDirection=0,t.startTime=L(),t.moved=!1,t.trigger(r,{index:t._getSelectedIndex()}))},e.prototype._move=function(e){var t=this,n=(e=P.getEvent(e))&&e.type||"",i=I[n],o=t._options;if(t.initiated===i){t._preventEvent(e);var r=t._getPos(e),a=r-t.pointPos;t.pointPos=r,t.moved||(t.trigger(c,{index:t._getSelectedIndex()}),t.moved=!0),t._scrollTo(M(t._r,a,t._angle,t._beginExceed,t._endExceed));var s=L();s-t.startTime>o.momentumLimitTime&&(t.momentumLimitTime=s,t.startPos=r)}},e.prototype._end=function(e){var t=this;e=P.getEvent(e);var n=t._options,i=e&&e.type||"",o=I[i];if(t.initiated===o&&(t.initiated=!1,t._preventEvent(e),t.trigger(F,{index:t._getSelectedIndex()}),!t._resetPos(n.bounceTime,S))){var r=L(),a=t._getPos(e),s=a-t.absStartPos,c=n.direction||"vertical";t.movingDirection="horizontal"===c?0<s?x.RIGHT:s<0?x.left:0:0<s?x.BOTTOM:s<0?x.TOP:0;var l,u,m,v,d,f,h,p,_,g,w,E=r-t.startTime,y=Math.abs(a-t.startPos),T=t._angle,b=0;if(n.momentum&&E<n.momentumLimitTime&&y>n.momentumLimitDistance){var A=(l=t.startPos,u=a,m=E,v=t._r,d=t._angle,f=t._beginExceed,h=t._endExceed,_=(u-l)/m,g=(p=n).swipeTime,p.swipeBounceTime,w=g,{angle:M(v,_/p.deceleration,d,f,h),duration:w});T=A.angle,b=A.duration}T!==t._angle&&(console.log("_newAngle---\x3e",T),t._scrollTo(T,b,O))}},e.prototype._transitionEnd=function(e){var t=this,n=t._options,i=P.getTarget(e);if((t.isInTransition||t.isAnimating)&&i===t._wheelEl){var o=p.cancelAnimationFrame;n.useTransition?(o(t.probeTimer),t.isInTransition=!1,t._setTransition(0,null)):(t.isAnimating=!1,o(t.animateTimer)),t._resetPos(n.bounceTime,S)||t.trigger(u,{index:t._getSelectedIndex()})}},e.prototype._resetPos=function(e,t){var n=this,i=n._angle,o=!1;return i<n._beginAngle?(i=n._beginAngle,o=!0):i>n._endAngle?(i=n._endAngle,o=!0):i=parseInt(i/n._itemAngle)*n._itemAngle,i!==n._angle&&n._scrollTo(i,e,t),o},e.prototype._scrollTo=function(e,t,n){var i=this,o=i._options;t?t&&o.useTransition?(i.isInTransition=!0,i._setTransition(t,n&&n.style),i._translateTo(e)):(i.isAnimating=!0,i._animate(e,t,n&&n.fn)):i._translateTo(e)},e.prototype._animate=function(i,o,r){var a=this;o=o||0;var s=a._angle,c=L(),l=c+o,u=p.requestAnimationFrame;(0,p.cancelAnimationFrame)(a.animateTimer),a.animateTimer=u(function e(){var t=L();if(l<=t)return a._translateTo(i),void a.dispatchEvent(a._wheelEl,m.transitionEnd);var n=s+r(t=(t-c)/o)*(i-s);a._translateTo(n),console.log("_newAngle--\x3e",n,i),a.isAnimating&&(a.animateTimer=u(e))})},e.prototype._translateTo=function(e){var t=this,n=t._options,i=t._wheelEl,o=n.direction||"vertical";if(i){var r="";r="horizontal"===o?"rotateY(-"+e+"deg)":"rotateX("+e+"deg)",i.style[m.transform]=r,t._angle=e,t._initItemVisibility(e),t.trigger(s,{index:t._getSelectedIndex()})}},e.prototype._setTransition=function(e,t){e=e||0;var n=this._wheelEl;n&&(n.style[m.transitionDuration]=e+"ms",n.style[m.transitionTimingFunction]=t)},e.prototype._getSelectedIndex=function(e){var t=e||this._angle,n=this._itemAngle,i=0;return n&&(i=parseInt(t/n),(i=Math.abs(i))<0?i=0:i>this._wheelItemsEl.length-1&&(i=this._wheelItemsEl.length-1)),i},e.prototype._getPos=function(e){var t=this._options;return((e=P.getEvent(e)).changedTouches?e.changedTouches[0]:e)["horizontal"===(t.direction||"vertical")?"pageX":"pageY"]},e.prototype._preventEvent=function(e){var t=this._options;e=P.getEvent(e),t.preventDefault&&!function(e,t){if(!e)return!0;for(var n in t=t||{})if(t.hasOwnProperty(n)){var i=t[n];if(i&&i.test instanceof Function&&i.test(e[n]))return!0}return!1}(P.getTarget(e),t.preventDefaultException)&&P.preventDefault(e),t.stopPropagation&&P.stopPropagation(e)},e.prototype.wheelTo=function(e){},e.prototype._watchTransition=function(){var r=this;if(void 0!==Object.defineProperty){var e=r._options,a=!1,t=e.useTransition?"isInTransition":"isAnimating";Object.defineProperty(r,t,{get:function(){return a},set:function(e){a=e;for(var t=r._wheelItemsEl?r._wheelItemsEl:[r._wheelEl],n=a?"none":"auto",i=0;i<t.length;i++){var o=t[i];o&&(o.style.pointerEvents=n)}}})}}}),w.use(function(e){e.prototype._initEl=function(e){var t=this._options;(this._wheelEl=this._getElements(t.wheelEl,e)[0])&&this._bindEvent(!0)},e.prototype._resetItems=function(){var e=this._wheelEl,t=this._options;if(e){var n=this._wheelItemsEl=this._getElements(t.wheelItemEl,e);(!n||n.length<=0)&&_("can not resolve wheel item")}},e.prototype._initItemVisibility=function(e){var t=this._options,n=this._wheelItemsEl;if(n&&0<n.length)for(var i=0;i<n.length;i++){var o=n[i],r=o._angle,a=Math.abs(e-r);a<this._highlightRange?o.classList.add(t.activeCls):a<this._visibleRange?(o.classList.add(t.visibleCls),o.classList.remove(t.activeCls)):(o.classList.remove(t.activeCls),o.classList.remove(t.visibleCls))}},e.prototype._calcItemPosition=function(){var e=this,t=e._wheelItemsEl,n=e._options.direction||"vertical";if(t&&0<t.length)for(var i=0;i<t.length;i++){var o=t[i];if(o){e._endAngle=e._itemAngle*i,o._index=i,o._angle=e._endAngle,o.style[a("transformOrigin")]="center center "+-e._r+"px";var r="translateZ("+e._r+"px)";"horizontal"===n?r+=" rotateY("+e._endAngle+"deg)":"vertical"===n&&(r+=" rotateX(-"+e._endAngle+"deg)"),o.style[a("transform")]=r}}e._endExceed=e._endAngle+30},e.prototype._getElements=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document,n=void 0;return e?"string"==typeof e?n=t.querySelectorAll(e):"number"!=typeof e.length&&(n=[e]):t&&t!==document&&t.children&&0<t.children.length&&(n=t.children),n&&!(n instanceof Array)&&n.length<1&&(n=[n]),n||[]}}),w.use(function(e){e.prototype.dispatchEvent=function(e,t,n){if(e&&e.tagName&&t&&"string"==typeof t){var i=document.createEvent(window&&window.MouseEvent?"MouseEvents":"Event");i.initEvent(t,!0,!1),i._constructed=!0,i=l(i,n),e.dispatchEvent(i)}},e.prototype.on=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this,i=this;i._events=i._events||{},i._events[e]=i._events[e]||[],i._events[e].push([t,n])},e.prototype.once=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this,i=this,o=!1;function r(){i.off(e,r),o||(o=!0,t.apply(n,arguments))}r.fn=t,i.on(e,r)},e.prototype.off=function(e,t){var n=this._events[e];if(n)for(var i=n.length;i--;)(n[i][0]===t||n[i][0]&&n[i][0].fn===t)&&(n[i][0]=void 0)},e.prototype.trigger=function(e){var t=this._events&&this._events[e];if(t)for(var n=t.length,i=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t)),o=0;o<n;o++){var r=i[o],a=g(r,2),s=a[0],c=a[1];s&&s.apply(c,[].slice.call(arguments,1))}}}),w.Version="0.0.1",e.default=w,e.Wheel=w,Object.defineProperty(e,"__esModule",{value:!0})});